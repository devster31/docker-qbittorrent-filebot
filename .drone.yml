---
kind: pipeline
type: digitalocean
name: default

token:
  from_secret: token

server:
  image: docker-18-04
  size: s-1vcpu-2gb
  region: lon1

platform:
  os: linux
  arch: amd64

steps:
# - name: build
#   image: plugins/docker
#   settings:
#     auto_tag: true
#     build_args_from_env:
#     - QBITTORRENT_VERSION
#     - FILEBOT_VERSION
#     - S6_OVERLAY_VERSION
#     repo: devster31/qbittorrent-filebot
#     username:
#       from_secret: docker_username
#     password:
#       from_secret: docker_password

- name: build
  commands:
  - echo $DOCKER_PASSWORD | docker login --username $DOCKER_USERNAME --password-stdin
  - ./build.sh
  - docker push devster31/qbittorrent-filebot
  environment:
    DOCKER_USERNAME:
      from_secret: docker_username
    DOCKER_PASSWORD:
      from_secret: docker_password

...